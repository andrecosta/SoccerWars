<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>[ SoccerWars ] Game</title>

    <!-- Styles -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/sweetalert/1.0.1/sweetalert.min.css" rel="stylesheet">
    <link href="css/app.css" rel="stylesheet">

    <!-- Vue Framework components -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/vue/0.12.6/vue.min.js"></script>
    <script src="js/plugins/vue-route.js"></script>

</head>
<body id="app">

    <section id="left" class="hologram">

        <div id="profile-picture" v-link="/profile">
            <img width="150" height="150" v-attr="src: user.avatar.big">
        </div>

        <div id="points">
            <span v-text="user.points"></span>
        </div>

        <nav id="main-menu">
            <ul>
                <li v-link="/dashboard" class="menu-item glitch neon">
                    <span data-text="Dashboard">Dashboard</span><span class="menu-icon"></span>
                </li>
                <li v-link="/matches" class="menu-item glitch neon">
                    <span data-text="Matches">Matches</span><span class="menu-icon"></span>
                </li>
                <li v-link="/teams" class="menu-item glitch neon">
                    <span data-text="Teams">Teams</span><span class="menu-icon"></span>
                </li>
                <li v-link="/users" class="menu-item glitch neon">
                    <span data-text="Users">Users</span><span class="menu-icon"></span>
                </li>
                <li v-link="/corporations" class="menu-item glitch neon">
                    <span data-text="Corporations">Corporations</span><span class="menu-icon"></span>
                </li>
                <li v-link="/market" class="menu-item glitch neon">
                    <span data-text="Market">Market</span><span class="menu-icon"></span>
                </li>
            </ul>
        </nav>

        <button id="#logout" v-on="click: logout">Logout</button>

    </section><!-- /#left -->

    <section id="middle" class="hologram">

        <header id="frame">
            <h1 class="scramble" v-text="title"></h1>
            <div class="buttons">
                <div v-on="click: maximize" v-show="!isMaximized">+</div>
                <div v-on="click: minimize" v-show="isMaximized">-</div>
            </div>
        </header>

        <main id="main">
            <router-view></router-view>
        </main>

    </section><!-- /#middle -->

    <section id="right" class="hologram">

        My bets

    </section><!-- /#right -->

    <!-- Dashboard template -->
    <template id="dashboard">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content" v-if="loaded">
            <h2>Recent activity and stuff</h2>
        </div>
    </template>

    <!-- Matches template -->
    <template id="matches">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content page-matches" v-if="loaded">
            <div class="top">
                <h2>Live matches</h2>
                <div v-repeat="matches | live | orderBy 'start_time'" v-on="click: go(id)" class="item">
                    <div class="teams"><span v-text="team_1.name"></span> vs <span v-text="team_2.name"></span></div>
                    <div class="time">Started: <span v-text="start_time"></span></div>
                </div>
            </div>

            <div class="columns">
                <div class="column grow">
                    <h2>Upcoming matches</h2>
                    <div v-repeat="matches | future | orderBy 'start_time'" v-on="click: go(id)" class="item">
                        <div class="teams"><span v-text="team_1.name"></span> vs <span v-text="team_2.name"></span></div>
                        <div class="time">Starts on: <span v-text="start_time"></span></div>
                    </div>
                </div>

                <div class="column grow">
                    <h2>Past matches</h2>
                    <div v-repeat="matches | past | orderBy 'end_time'" class="item">
                        <div class="teams"><span v-text="team_1.name"></span> vs <span v-text="team_2.name"></span></div>
                        <div class="time">Ended on: <span v-text="end_time"></span></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Match details template -->
    <template id="match-details">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content page-match-details" v-if="loaded">
            <h2>Match progress</h2>
            <div class="time">Start time: <span v-text="match.start_time"></span></div>
            <div class="columns">
                <div class="column grow" style="text-align: right">
                    <h2 v-text="match.team_1.name"></h2>
                    <div v-text="match.progress[0].goals"></div>
                    <div v-text="match.progress[0].yellow_cards"></div>
                    <div v-text="match.progress[0].red_cards"></div>
                    <div v-text="match.progress[0].defenses"></div>
                </div>
                <div class="column shrink labels">
                    <h2>VS</h2>
                    <div>GOALS</div>
                    <div>Yellow Cards</div>
                    <div>Red Cards</div>
                    <div>Defenses</div>
                </div>
                <div class="column grow" style="text-align: left">
                    <h2 v-text="match.team_2.name"></h2>
                    <div v-text="match.progress[1].goals"></div>
                    <div v-text="match.progress[1].yellow_cards"></div>
                    <div v-text="match.progress[1].red_cards"></div>
                    <div v-text="match.progress[1].defenses"></div>
                </div>
            </div>
            <h2>Bet</h2>
            <div></div>
            <h2>Comments</h2>
            <div></div>
        </div>
    </template>

    <!-- Teams template -->
    <template id="teams">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content" v-if="loaded">
            <h2>Teams list</h2>
            <div v-repeat="teams">
                <span v-text="name"></span>
                <div v-text="rank"></div>
            </div>
        </div>
    </template>

    <!-- Users template -->
    <template id="users">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content page-users" v-if="loaded">
            <h2>Leaderboard</h2>
            <div v-repeat="users | orderBy 'points' -1" class="item columns" v-on="click: go(id)">
                <div class="column shrink">
                    {{$index+1}}. &nbsp;&nbsp;<img v-attr="src: avatar.small" width="32" height="32" class="avatar"><span v-text="name"></span>
                </div>
                <div class="column grow badges">
                    <div>
                        <div v-repeat="badge: badges" v-style="background-image: 'url(' + badge.image + ')',
                                      background-position: badge.unlocked*24 + 'px 0'" v-attr="title: badge.name" class="badge"></div>
                    </div>
                </div>
                <div class="column shrink points">
                    <span v-text="points"></span>
                </div>
            </div>
        </div>
    </template>

    <!-- User details template DELETEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE -->
    <template id="user-details">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content" v-if="loaded">
            <h2>User profile</h2>
            <img v-attr="src: user.avatar.big" width="150" height="150"><span v-text="user.name"></span>
        </div>
    </template>

    <!-- Profile template -->
    <template id="profile">
        <div class="loading" v-if="!loaded"><span>Loading...</span></div>
        <div class="content" v-if="loaded">
            <h2>Profile details</h2>
            <img v-attr="src: user.avatar.big" width="150" height="150">
            <span v-text="user.name"></span>
        </div>
    </template>

    <!-- Extra plugins -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lettering.js/0.7.0/jquery.lettering.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.2/velocity.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/Cookies.js/1.2.1/cookies.min.js"></script>
    <script src="js/plugins/jquery.neon.min.js"></script>
    <script src="js/plugins/sweetalert-dev.js"></script>

    <!-- Main application scripts & components -->
    <script src="js/effects.js"></script>
    <script src="js/app.js"></script>
    <script src="js/components/dashboard.js"></script>
    <script src="js/components/matches.js"></script>
    <script src="js/components/match-details.js"></script>
    <script src="js/components/teams.js"></script>
    <script src="js/components/users.js"></script>
    <script src="js/components/user-details.js"></script>
    <script src="js/components/profile.js"></script>
    <script src="js/routes.js"></script>

    <!--
    <header>
        <nav id="top-menu">
            <ul>
                <?php if (!isset($_SESSION['uid'])) { ?>
                    <li><a href="/#register">Create Account</a></li>
                    <li><a href="/#login">Login</a></li>
                <?php } else { ?>
                    <li><a href="#">My Profile (<?=$_SESSION["username"]?>)</a></li>
                    <li><a href="logout.php">Logout</a></li>
                <?php } ?>
            </ul>
        </nav>

    </header>

    <main>

    <section class="wide">
        <div class="title"><span class="live"></span> Live Matches</div>
        <div class="content">
            <?php
            $matches = mysqli_query($connection, "SELECT * FROM `Match` WHERE StartTime < NOW() AND NOW() < EndTime");
            while ($match = mysqli_fetch_array($matches)) {
                $teams = mysqli_query($connection, "SELECT * FROM Team, MatchProgress WHERE MatchID = $match[ID] AND Team.ID = MatchProgress.TeamID GROUP BY Name");
                $team_details = [];
                while ($team_details[] = mysqli_fetch_array($teams));
                ?>
                <div class="match">
                    <div><span class="label green">! IN PROGRESS !</span></div>
                    <span class="score"><?=$team_details[0]["Goals"]?></span>
                    <span class="label cyan">SCORE</span>
                    <span class="score"><?=$team_details[1]["Goals"]?></span>
                    <div class="teams">
                        <div class="left-team"><?=$team_details[0]["Name"]?></div>
                        <span class="vs">[VS]</span>
                        <?=$team_details[1]["Name"]?></div>
                </div>
            <?php } ?>
        </div>
    </section>

    <section class="regular">
        <div class="title">Upcoming Matches</div>
        <div class="content">
            <?php
            $matches = mysqli_query($connection, "SELECT * FROM `Match` WHERE StartTime > NOW()");
            while ($match = mysqli_fetch_array($matches)) {
                $teams = mysqli_query($connection, "SELECT * FROM Team, MatchProgress WHERE MatchID = $match[ID] AND Team.ID = MatchProgress.TeamID GROUP BY Name");
                $team_details = [];
                while ($team_details[] = mysqli_fetch_array($teams));
                ?>
                <div class="match">
                    <div><span class="label green">STARTING ON</span> <span class="time"><?=$match["StartTime"]?></span></div>
                    <div class="teams">
                        <div class="left-team"><?=$team_details[0]["Name"]?></div>
                        <span class="vs">[VS]</span>
                        <?=$team_details[1]["Name"]?></div>
                </div>
            <?php } ?>
        </div>
    </section>

    <section class="regular">
        <div class="title">Past Matches</div>
        <div class="content">
            <?php
            $matches = mysqli_query($connection, "SELECT * FROM `Match` WHERE EndTime < NOW()");
            while ($match = mysqli_fetch_array($matches)) {
                $teams = mysqli_query($connection, "SELECT * FROM Team, MatchProgress WHERE MatchID = $match[ID] AND Team.ID = MatchProgress.TeamID GROUP BY Name");
                $team_details = [];
                while ($team_details[] = mysqli_fetch_array($teams));
                ?>
                <div class="match">
                    <div><span class="label red">ENDED</span> <span class="time"><?=$match["StartTime"]?></span></div>
                    <span class="score"><?=$team_details[0]["Goals"]?></span>
                    <span class="label cyan">SCORE</span>
                    <span class="score"><?=$team_details[1]["Goals"]?></span>
                    <div class="teams">
                        <div class="left-team"><?=$team_details[0]["Name"]?></div>
                        <span class="vs">[VS]</span>
                        <?=$team_details[1]["Name"]?></div>
                </div>
            <?php } ?>
        </div>
    </section>

    </main>
    -->

</body>
</html>